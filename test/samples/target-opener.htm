<!doctype html>
<html lang="en-gb">
<head>
  <meta charset="utf-8" />
  <title>Target opener</title>
  <link rel="stylesheet" href="style.css" />
  <script>
    if (window.opener) {
      window.opener.location.href = 'https://www.youtube.com/watch?v=dQw4w9WgXcQ';
    }
    function updateBase() {
      let base = document.querySelector('base');
      if (base) {
        base.remove();
      } else {
        base = document.createElement('base');
        base.target = '_blank';
        document.head.appendChild(base);
      }
    }
  </script>
<body>
  <header>
    <h1>Target opener</h1>
    <p>Tests opener vulnerability using target on a link</p>
  </header>
  <main>
    <h2>Test vulnerable links</h2>
    <ul>
      <li><a href="?" target="_blank">target="_blank"</a></li>
      <li><a href="?" target="named">target="named"</a></li>
      <li>
        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=" usemap="#map1" width="100px" height="20px" />
        <map name="map1">
          <area shape="rect" coords="0,0 100,20" href="?" target="_blank" title="click me" />
        </map>
      </li>
      <li><button type="button" onclick="updateBase()">Add base</button><a href="?">Normal link</a></li>
      <li><form target="_blank" action="?"><input type="submit" value="Using form" /></form></li>
      <li><form action="?"><input type="submit" formtarget="_blank" value="Using formtarget" /></form></li>
    </ul>

    <h2>Test adding noopener</h2>
    <ul>
      <li><a href="?" target="_blank" rel="noopener">target="_blank"</a></li>
      <li><a href="?" target="named" rel="noopener">target="named"</a></li>
      <li>
        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=" usemap="#map2" width="100px" height="20px" />
        <map name="map2">
          <area shape="rect" coords="0,0 100,20" href="?" target="_blank" rel="noopener" title="click me" />
        </map>
      </li>
      <li><button type="button" onclick="updateBase()">Add base</button><a rel="noopener" href="?">Normal link</a></li>
      <li><form target="_blank" action="?" rel="noopener"><input type="submit" value="Using form" /></form></li>
      <li><form action="?" rel="noopener"><input type="submit" formtarget="_blank" value="Using formtarget" /></form></li>
    </ul>

    <h2>Test adding noreferrer</h2>
    <ul>
      <li><a href="?" target="_blank" rel="noreferrer">target="_blank"</a></li>
      <li><a href="?" target="named" rel="noreferrer">target="named"</a></li>
      <li>
        <img src="data:image/gif;base64,R0lGODlhAQABAIAAAAUEBAAAACwAAAAAAQABAAACAkQBADs=" usemap="#map3" width="100px" height="20px" />
        <map name="map3">
          <area shape="rect" coords="0,0 100,20" href="?" target="_blank" rel="noreferrer" title="click me" />
        </map>
      </li>
      <li><button type="button" onclick="updateBase()">Add base</button><a rel="noreferrer" href="?">Normal link</a></li>
      <li><form target="_blank" action="?" rel="noreferrer"><input type="submit" value="Using form" /></form></li>
      <li><form action="?" rel="noreferrer"><input type="submit" formtarget="_blank" value="Using formtarget" /></form></li>
    </ul>
  </main>
</body>
